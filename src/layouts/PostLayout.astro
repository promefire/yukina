---
import Main from "../layouts/MainLayout.astro";
import Markdown from "../components/Markdown.astro";
import CopyRight from "../components/misc/CopyRight.astro";
import Comments from "../components/Comments.astro";
import PasswordProtected from "../components/PasswordProtected.astro";

interface Props {
  title?: string;
  subTitle?: string;
  bannerImage?: string;
  published?: Date;
  license?: {
    name: string;
    url?: string;
  };
  author?: string;
  sourceLink?: string;
  password?: string;
}

const {
  title,
  subTitle,
  bannerImage,
  published,
  license,
  author,
  sourceLink,
  password,
} = Astro.props;
---

<Main 
  title={title} 
  subTitle={subTitle} 
  bannerImage={bannerImage}
  hideCategories={false}
  hideTags={false}
>
  <div class="article-wrapper">
    <div class="article">
      {password ? (
        <PasswordProtected password={password}>
          <Markdown>
            <slot />
          </Markdown>
          {published && title && (
            <CopyRight
              title={title}
              published={published}
              license={license}
              author={author}
              sourceLink={sourceLink}
            />
          )}
          <Comments />
        </PasswordProtected>
      ) : (
        <>
          <Markdown>
            <slot />
          </Markdown>
          {published && title && (
            <CopyRight
              title={title}
              published={published}
              license={license}
              author={author}
              sourceLink={sourceLink}
            />
          )}
          <Comments />
        </>
      )}
    </div>
  </div>
</Main>

<style>
  .article-wrapper {
    @apply mx-3 rounded-2xl bg-[var(--card-color)] px-5 py-6 lg:mx-0 lg:px-10 lg:py-9;
  }
  .article {
    @apply flex flex-col;
    font-size: var(--primary-font);
  }
</style>
